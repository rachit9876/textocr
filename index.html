<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OCR Text Comparison</title>
    <script src="https://unpkg.com/tesseract.js@5.0.0/dist/tesseract.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 min-h-screen">
    <div class="max-w-2xl mx-auto px-6 py-12">
        <div class="text-center mb-12">
            <h1 class="text-3xl font-light text-white mb-2">Order Number OCR</h1>
            <p class="text-gray-400">Upload an image to extract order number</p>
        </div>
        
        <div class="bg-gray-800 rounded-xl shadow-sm border border-gray-700 p-8 space-y-8">
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-3">Image</label>
                <input type="file" id="imageInput" accept="image/*" 
                       class="block w-full text-sm text-gray-400 file:mr-4 file:py-3 file:px-6 file:rounded-lg file:border-0 file:bg-gray-700 file:text-gray-300 hover:file:bg-gray-600 transition-colors">
            </div>
            
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-3">Enter Order Number (without '-' )</label>
                <input type="text" id="expectedText" 
                       placeholder="Enter the exact order number..."
                       class="w-full px-4 py-3 border border-gray-600 bg-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-300 placeholder-gray-500">
            </div>
            
            <button onclick="compareText()" 
                    class="w-full bg-blue-600 text-white py-3 px-6 rounded-lg hover:bg-blue-700 transition-colors font-medium">
                Extract Order Number & Check Delivery
            </button>
            
            <div id="result"></div>
        </div>
    </div>

    <script>
        function extractOrderNumber(text) {
            const match = text.match(/order\s+number\s*[~\s]*([\d-\s]+)/i);
            if (match) {
                return match[1].replace(/[-\s]/g, '');
            }
            return null;
        }

        function checkDeliveryStatus(text) {
            return /delivered/i.test(text);
        }

        async function compareText() {
            const imageInput = document.getElementById('imageInput');
            const expectedText = document.getElementById('expectedText').value.trim();
            const resultDiv = document.getElementById('result');
            
            if (!imageInput.files[0]) {
                resultDiv.innerHTML = '<div class="p-4 bg-red-900/20 border border-red-800 rounded-lg text-red-400">Please upload an image</div>';
                return;
            }
            
            if (!expectedText) {
                resultDiv.innerHTML = '<div class="p-4 bg-red-900/20 border border-red-800 rounded-lg text-red-400">Please enter order number</div>';
                return;
            }
            
            resultDiv.innerHTML = '<div class="p-4 bg-blue-900/20 border border-blue-800 rounded-lg text-blue-400 flex items-center gap-2"><div class="w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"></div>Extracting order number...</div>';
            
            try {
                const { data: { text } } = await Tesseract.recognize(imageInput.files[0], 'eng');
                
                const extractedOrderNumber = extractOrderNumber(text);
                const isDelivered = checkDeliveryStatus(text);
                
                if (!extractedOrderNumber) {
                    resultDiv.innerHTML = `
                        <div class="p-4 bg-yellow-900/20 border border-yellow-800 rounded-lg text-yellow-400">
                            <div class="font-semibold mb-2">No order number found</div>
                            <div class="text-sm mb-2">Delivery Status: ${isDelivered ? '✓ Delivered' : '✗ Not Delivered'}</div>
                            <details class="text-xs">
                                <summary class="cursor-pointer">View extracted text</summary>
                                <pre class="mt-2 p-2 bg-gray-700 rounded text-gray-300 whitespace-pre-wrap">${text}</pre>
                            </details>
                        </div>
                    `;
                    return;
                }
                
                const isMatch = extractedOrderNumber === expectedText;
                
                resultDiv.innerHTML = `
                    <div class="p-4 ${isMatch ? 'bg-green-900/20 border-green-800 text-green-400' : 'bg-red-900/20 border-red-800 text-red-400'} border rounded-lg">
                        <div class="font-semibold mb-2">${isMatch ? '✓ EXACT MATCH' : '✗ NO MATCH'}</div>
                        <div class="text-sm space-y-1">
                            <div><span class="font-medium">Extracted Order Number:</span> "${extractedOrderNumber}"</div>
                            <div><span class="font-medium">Expected:</span> "${expectedText}"</div>
                            <div class="mt-2 ${isDelivered ? 'text-green-400' : 'text-red-400'}"><span class="font-medium">Delivery Status:</span> ${isDelivered ? '✓ Delivered' : '✗ Not Delivered'}</div>
                        </div>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = '<div class="p-4 bg-red-900/20 border border-red-800 rounded-lg text-red-400">Error processing image</div>';
            }
        }
    </script>
</body>
</html>